# Network 模块

一旦我所属的文件夹有所变化，请更新我。

## 架构概述

网络状态服务层，负责监控设备网络连接状态、连接类型识别、网络质量评估和状态变化通知。

## 文件清单

| 文件 | 地位 | 功能 |
|------|------|------|
| `index.ts` | 入口 | 模块统一导出 |
| `types.ts` | 类型 | 网络状态相关类型定义 |
| `networkService.ts` | 核心 | expo-network 集成、状态轮询、质量评估、监听管理 |

## 网络连接类型

| 类型 | 说明 |
|------|------|
| `wifi` | WiFi 连接 |
| `cellular` | 蜂窝数据 (2G/3G/4G/5G) |
| `ethernet` | 以太网 |
| `bluetooth` | 蓝牙 |
| `vpn` | VPN |
| `wimax` | WiMAX |
| `other` | 其他类型 |
| `unknown` | 未知 |
| `none` | 无连接 |

## 网络质量等级

| 等级 | 场景 | 建议 |
|------|------|------|
| `excellent` | WiFi/5G/以太网 | 可进行大文件传输和实时通信 |
| `good` | 4G/LTE | 可进行实时通信，大文件需谨慎 |
| `fair` | 3G | 仅适合基本数据同步 |
| `poor` | 2G | 仅适合文字消息 |
| `none` | 无连接 | 离线模式 |

## 核心功能

### 初始化服务
```typescript
import { initializeNetworkService, addNetworkStateListener } from '@/network';

// 启动时初始化 (默认 5秒轮询)
await initializeNetworkService({ pollInterval: 5000 });

// 监听网络变化
const unsubscribe = addNetworkStateListener((event) => {
    console.log(`Network changed: ${event.previous.type} -> ${event.current.type}`);
    if (!event.current.isConnected) {
        // 显示离线提示
    }
});
```

### 获取网络状态
```typescript
import { getNetworkState, isConnected, isOnWifi } from '@/network';

// 完整状态
const state = await getNetworkState();
// {
//   isConnected: true,
//   isInternetReachable: true,
//   type: 'wifi',
//   isWifi: true,
//   isCellular: false,
//   cellularGeneration: null,
//   isExpensive: false
// }

// 快速检查
const connected = await isConnected();
const onWifi = await isOnWifi();
```

### 评估网络质量
```typescript
import { getNetworkQuality } from '@/network';

const quality = await getNetworkQuality();
// {
//   quality: 'excellent',
//   suitableForLargeTransfers: true,
//   suitableForRealtime: true,
//   description: 'High-speed connection'
// }

// 基于质量决定行为
if (quality.suitableForLargeTransfers) {
    // 预加载资源
}
```

### 获取 IP 地址
```typescript
import { getIPAddress } from '@/network';

const ipInfo = await getIPAddress();
// { ip: '192.168.1.100', subnet: null }
```

### 检查飞行模式 (Android)
```typescript
import { isAirplaneModeEnabled } from '@/network';

const { isEnabled } = await isAirplaneModeEnabled();
```

## 依赖

- `expo-network` - 网络状态核心 (需要安装)
- `@/log` - 日志记录

## 安装依赖

```bash
npx expo install expo-network
```


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>